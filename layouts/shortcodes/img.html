{{ $img := $.Page.Resources.GetMatch (.Get "src")}}

{{ if eq $img nil }}
{{ errorf "Cannot load image (check spelling?): <%s%s>" ($.Page.RelPermalink) (.Get "src") }}
{{ else }}

{{ $img600 := $img.Fit "1000x800" }}
{{ $img1200 := $img.Fit "2000x1600" }}

<div>
  <a href="{{ $img.RelPermalink }}">
  <img
    src="{{ $img600.RelPermalink }}"
    srcset="{{ $img1200.RelPermalink }} 2x"
    {{ with .Get "title" }}title="{{ . }}"{{ end }}
    {{ if or (.Get "alt") (.Get "title") }}
    alt="{{ with .Get "alt"}}{{.}}{{else}}{{ .Get "title" }}{{ end }}"
    {{ end }}
  />
  </a>
  {{ with .Get "caption" }}
  <span style="display: inline-block;font-style: italic;padding-bottom: 20px">{{ . }}</span>
  {{ end }}
</div>
{{ end }}
